# é˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ðŸ“‹ æœåŠ¡å™¨ä¿¡æ¯
- **å…¬ç½‘IP**: 47.97.251.249
- **ç³»ç»Ÿ**: Linux (UbuntuæŽ¨è)
- **é¡¹ç›®åœ°å€**: https://github.com/landc3/Navigation_Chatbot.git

---

## ðŸ” ç¬¬1æ­¥ï¼šé…ç½®å®‰å…¨ç»„è§„åˆ™

åœ¨é˜¿é‡Œäº‘æŽ§åˆ¶å°é…ç½®å®‰å…¨ç»„ï¼Œç¡®ä¿å¼€æ”¾ä»¥ä¸‹ç«¯å£ï¼š

| ç«¯å£ | åè®® | è¯´æ˜Ž | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| 80 | TCP | HTTPå‰ç«¯è®¿é—® | **å¿…é¡»** |
| 8000 | TCP | åŽç«¯APIæœåŠ¡ | **å¿…é¡»** |
| 22 | TCP | SSHè¿œç¨‹ç®¡ç† | **å¿…é¡»**ï¼ˆå»ºè®®é™åˆ¶æ¥æºIPï¼‰ |

### é…ç½®æ­¥éª¤ï¼š
1. ç™»å½•é˜¿é‡Œäº‘æŽ§åˆ¶å°
2. è¿›å…¥ **ECS** â†’ **å®žä¾‹** â†’ æ‰¾åˆ°ä½ çš„æœåŠ¡å™¨
3. ç‚¹å‡» **å®‰å…¨ç»„** â†’ **é…ç½®è§„åˆ™**
4. ç‚¹å‡» **æ·»åŠ å®‰å…¨ç»„è§„åˆ™**
5. æ·»åŠ ä»¥ä¸‹è§„åˆ™ï¼š
   - **ç«¯å£80**: æŽˆæƒå¯¹è±¡ `0.0.0.0/0`ï¼ˆå…è®¸æ‰€æœ‰IPè®¿é—®ï¼‰
   - **ç«¯å£8000**: æŽˆæƒå¯¹è±¡ `0.0.0.0/0`
   - **ç«¯å£22**: æŽˆæƒå¯¹è±¡ `ä½ çš„IP/32`ï¼ˆå»ºè®®åªå…è®¸ä½ çš„IPè®¿é—®ï¼‰

---

## ðŸš€ ç¬¬2æ­¥ï¼šSSHè¿žæŽ¥åˆ°æœåŠ¡å™¨

### Windows PowerShell:
```powershell
ssh root@47.97.251.249
```

### é¦–æ¬¡è¿žæŽ¥ä¼šæç¤ºï¼Œè¾“å…¥ `yes`
### è¾“å…¥rootå¯†ç ï¼ˆé˜¿é‡Œäº‘æŽ§åˆ¶å°è®¾ç½®çš„å¯†ç ï¼‰

---

## ðŸ“¥ ç¬¬3æ­¥ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæŽ¨èï¼‰

### æ–¹æ³•Aï¼šä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

1. **ä¸Šä¼ éƒ¨ç½²è„šæœ¬åˆ°æœåŠ¡å™¨**

åœ¨æœ¬åœ°æ‰§è¡Œï¼ˆPowerShellï¼‰ï¼š
```powershell
# å°†éƒ¨ç½²è„šæœ¬ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp éƒ¨ç½²è„šæœ¬_é˜¿é‡Œäº‘_47.97.251.249.sh root@47.97.251.249:/root/
```

2. **åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œéƒ¨ç½²è„šæœ¬**

SSHè¿žæŽ¥åˆ°æœåŠ¡å™¨åŽï¼š
```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x /root/éƒ¨ç½²è„šæœ¬_é˜¿é‡Œäº‘_47.97.251.249.sh

# æ‰§è¡Œéƒ¨ç½²è„šæœ¬
/root/éƒ¨ç½²è„šæœ¬_é˜¿é‡Œäº‘_47.97.251.249.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
- âœ… å®‰è£…Dockerå’ŒDocker Compose
- âœ… å…‹éš†GitHubé¡¹ç›®
- âœ… é…ç½®çŽ¯å¢ƒå˜é‡
- âœ… æž„å»ºå¹¶å¯åŠ¨å®¹å™¨

---

### æ–¹æ³•Bï¼šæ‰‹åŠ¨éƒ¨ç½²

#### 3.1 å®‰è£…Dockerå’ŒDocker Compose

```bash
# æ›´æ–°ç³»ç»Ÿ
apt update && apt upgrade -y

# å®‰è£…Docker
curl -fsSL https://get.docker.com | bash
systemctl enable docker
systemctl start docker

# éªŒè¯Docker
docker --version

# å®‰è£…Docker Compose
curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

# éªŒè¯Docker Compose
docker compose version
```

#### 3.2 å…‹éš†é¡¹ç›®

```bash
# å®‰è£…Git
apt install git -y

# å…‹éš†é¡¹ç›®
cd /root
git clone https://github.com/landc3/Navigation_Chatbot.git
cd Navigation_Chatbot
```

#### 3.3 é…ç½®çŽ¯å¢ƒå˜é‡

```bash
# å¤åˆ¶çŽ¯å¢ƒå˜é‡æ¨¡æ¿
cp env.example .env

# ç¼–è¾‘çŽ¯å¢ƒå˜é‡
nano .env
```

**ç¼–è¾‘å†…å®¹**ï¼ˆå¿…é¡»ä¿®æ”¹ `ALI_QWEN_API_KEY`ï¼‰ï¼š
```env
ALI_QWEN_API_KEY=sk-ä½ çš„çœŸå®žAPIå¯†é’¥
ALI_QWEN_MODEL=qwen-plus-2025-07-28
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
```

**ä¿å­˜**: æŒ‰ `Ctrl + X`ï¼Œç„¶åŽ `Y`ï¼Œç„¶åŽ `Enter`

> ðŸ’¡ **èŽ·å–APIå¯†é’¥**: https://dashscope.console.aliyun.com/

#### 3.4 å¯åŠ¨åº”ç”¨

```bash
# æž„å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼ˆåŽå°è¿è¡Œï¼‰
docker compose up --build -d

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps
```

åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªå®¹å™¨ï¼š
- `navigation_chatbot-backend-1`
- `navigation_chatbot-frontend-1`

---

## âœ… ç¬¬4æ­¥ï¼šéªŒè¯éƒ¨ç½²

### 4.1 æ£€æŸ¥å®¹å™¨çŠ¶æ€

```bash
docker ps
```

åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªå®¹å™¨éƒ½åœ¨è¿è¡Œï¼ˆSTATUSä¸º `Up`ï¼‰

### 4.2 æŸ¥çœ‹æ—¥å¿—ï¼ˆå¦‚æœ‰é—®é¢˜ï¼‰

```bash
# æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
docker compose logs -f

# æŸ¥çœ‹åŽç«¯æ—¥å¿—
docker compose logs backend

# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker compose logs frontend
```

### 4.3 æµ‹è¯•æœåŠ¡

åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•ï¼š
```bash
# æµ‹è¯•åŽç«¯å¥åº·æ£€æŸ¥
curl http://localhost:8000/api/health

# åº”è¯¥è¿”å›ž: {"status":"ok"}
```

### 4.4 æµè§ˆå™¨è®¿é—®

æ‰“å¼€æµè§ˆå™¨è®¿é—®ä»¥ä¸‹åœ°å€ï¼š

- âœ… **å‰ç«¯åº”ç”¨**: http://47.97.251.249
- âœ… **åŽç«¯API**: http://47.97.251.249:8000
- âœ… **APIæ–‡æ¡£**: http://47.97.251.249:8000/docs

---

## ðŸ”§ å¸¸ç”¨è¿ç»´å‘½ä»¤

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /root/Navigation_Chatbot

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f

# é‡å¯æœåŠ¡
docker compose restart

# åœæ­¢æœåŠ¡
docker compose down

# æ›´æ–°ä»£ç åŽé‡æ–°éƒ¨ç½²
git pull
docker compose up --build -d

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats
```

---

## ðŸ› é—®é¢˜æŽ’æŸ¥

### é—®é¢˜1ï¼šæ— æ³•è®¿é—®å‰ç«¯ï¼ˆhttp://47.97.251.249ï¼‰

**æ£€æŸ¥æ¸…å•**ï¼š
1. âœ… å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾ç«¯å£80ï¼Ÿ
2. âœ… å®¹å™¨æ˜¯å¦è¿è¡Œï¼Ÿ`docker ps`
3. âœ… æŸ¥çœ‹å‰ç«¯æ—¥å¿—ï¼š`docker compose logs frontend`
4. âœ… æ£€æŸ¥é˜²ç«å¢™ï¼š`ufw status`ï¼ˆå¦‚æžœå¯ç”¨ï¼Œéœ€è¦å¼€æ”¾ç«¯å£ï¼‰

### é—®é¢˜2ï¼šåŽç«¯APIæ— æ³•è®¿é—®

**æ£€æŸ¥æ¸…å•**ï¼š
1. âœ… å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾ç«¯å£8000ï¼Ÿ
2. âœ… åŽç«¯å®¹å™¨æ˜¯å¦è¿è¡Œï¼Ÿ`docker ps | grep backend`
3. âœ… æŸ¥çœ‹åŽç«¯æ—¥å¿—ï¼š`docker compose logs backend`
4. âœ… æµ‹è¯•æœ¬åœ°è®¿é—®ï¼š`curl http://localhost:8000/api/health`

### é—®é¢˜3ï¼šå®¹å™¨å¯åŠ¨å¤±è´¥

**æ£€æŸ¥æ¸…å•**ï¼š
1. âœ… æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š`docker compose logs`
2. âœ… æ£€æŸ¥çŽ¯å¢ƒå˜é‡ï¼š`cat .env`
3. âœ… æ£€æŸ¥ç£ç›˜ç©ºé—´ï¼š`df -h`
4. âœ… æ£€æŸ¥å†…å­˜ï¼š`free -h`

### é—®é¢˜4ï¼šAPIå¯†é’¥é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼š
```bash
# ç¼–è¾‘çŽ¯å¢ƒå˜é‡
nano /root/Navigation_Chatbot/.env

# ä¿®æ”¹ ALI_QWEN_API_KEY ä¸ºæ­£ç¡®çš„å€¼
# ä¿å­˜åŽé‡å¯å®¹å™¨
docker compose restart backend
```

---

## ðŸ”„ æ›´æ–°ä»£ç 

å½“GitHubä»“åº“æœ‰æ›´æ–°æ—¶ï¼š

```bash
cd /root/Navigation_Chatbot

# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# é‡æ–°æž„å»ºå¹¶å¯åŠ¨
docker compose up --build -d
```

---

## ðŸ“Š ç›‘æŽ§å’Œç»´æŠ¤

### è®¾ç½®è‡ªåŠ¨é‡å¯ï¼ˆæœåŠ¡å™¨é‡å¯åŽè‡ªåŠ¨å¯åŠ¨å®¹å™¨ï¼‰

```bash
# ç¼–è¾‘Docker Composeé…ç½®ï¼Œæ·»åŠ restartç­–ç•¥
# æˆ–è€…ä½¿ç”¨systemdæœåŠ¡ï¼ˆæŽ¨èï¼‰

# åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
cat > /etc/systemd/system/navigation-chatbot.service << EOF
[Unit]
Description=Navigation Chatbot
Requires=docker.service
After=docker.service

[Service]
Type=oneshot
RemainAfterExit=yes
WorkingDirectory=/root/Navigation_Chatbot
ExecStart=/usr/local/bin/docker-compose up -d
ExecStop=/usr/local/bin/docker-compose down
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target
EOF

# å¯ç”¨æœåŠ¡
systemctl enable navigation-chatbot.service
systemctl start navigation-chatbot.service
```

---

## ðŸŽ¯ éƒ¨ç½²å®ŒæˆåŽçš„è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ | è¯´æ˜Ž |
|------|------|------|
| å‰ç«¯åº”ç”¨ | http://47.97.251.249 | ç”¨æˆ·è®¿é—®çš„ä¸»ç•Œé¢ |
| åŽç«¯API | http://47.97.251.249:8000 | APIæœåŠ¡ |
| APIæ–‡æ¡£ | http://47.97.251.249:8000/docs | Swagger APIæ–‡æ¡£ |

---

## ðŸ“ž éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æžœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. å®‰å…¨ç»„é…ç½®æ˜¯å¦æ­£ç¡®
2. å®¹å™¨æ—¥å¿—ï¼š`docker compose logs`
3. æœåŠ¡å™¨èµ„æºï¼š`df -h` å’Œ `free -h`
4. ç½‘ç»œè¿žæŽ¥ï¼š`ping 47.97.251.249`

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ðŸŽ‰

